<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Product</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="assets/styles/Styles.css">
    <link rel="stylesheet" href="assets/styles/AdminStyles.css">

    <script src="https://code.jquery.com/jquery-4.0.0.js" integrity="sha256-9fsHeVnKBvqh3FB2HYu7g2xseAZ5MlN6Kz/qnkASV8U=" crossorigin="anonymous"></script>

  </head>
  <body>
    <div class="d-flex flex-column min-vh-100">

      <header>
        <!-- place navbar here -->
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
          <div class="container-fluid px-5">
            <div class="logo d-flex align-items-center gap-2">
              <div class="icon-bakery p-2 rounded-lg text-white">
                <span class="material-symbols-outlined text-2xl">bakery_dining</span>
              </div>
              <a class="navbar-brand mb-0 h1" href="#">SweetBakey Admin</a>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                  <a class="nav-link" href="index.html">Dashboard</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" aria-current="page" href="adminInventory.html">Inventory</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Orders</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Costumers</a>
                </li>
              </ul>

              <div class="d-flex align-items-center gap-3">
                <!-- Notifications button -->
                <button class="btn btn-light rounded-circle text-secondary d-none d-sm-block">
                  <span class="material-symbols-outlined">notifications</span>
                </button>
                <!-- Avatar -->
                <div class="avatar">
                  <img
                    src="https://lh3.googleusercontent.com/aida-public/AB6AXuAhYzjmjHM_TEwjvUv0BAF1w-kFI6IjvdZGHWTIEITvyp0XNbTj6sPzwAn3LMhqImrqGu31s_lt-g2LPllQV5DqL2wu4uZrMcUd6rtijCx-VFpHYHVD6jPrSJHeCq4fTtDdcnogSTGw9v4WF-RVSDe1sAegix0VGreJ_69QmaDvu2DXgj4wZfxBaYCinJwIKsQPzMIrkVvu0aIZefvRRlGxGF9UZEyu-KySG86-Dr9i5AQLcHJVOyVG_KPcEZS0TgYmTg9GckJ_7bo"
                    alt="Admin user profile avatar"
                  />
                </div>

              </div>
            </div>
          </div>
        </nav>
      </header>

      <!-- Main -->
      <main class="flex-grow-1">
        <div class="container-xl py-5">
          <div id="product-root"></div> <!--tarjeta principal-->
          <section class="mt-5">
            <div class="d-flex align-items-center justify-content-between mb-4">
              <h3 class="h5 fw-extrabold mb-0">You May Also Like</h3>
              <a href="#" class="text-decoration-none fw-bold text-primary">View All <span class="material-symbols-outlined ms-1">arrow_forward</span></a>
            </div>
            <div id="related-products" class="row g-4"></div>
          </section>
        </div>
      </main>

      <!-- Footer -->
      <footer class="mt-auto" style="background-color:transparent">
        <div class="container-xl py-5">
          <div class="row gy-4">
            <div class="col-12 col-md-3">
              <div class="d-flex align-items-center gap-3 mb-3">
                <div class="logo d-flex align-items-center gap-2">
                  <div class="icon-bakery p-2 rounded-lg text-white">
                    <span class="material-symbols-outlined text-2xl">bakery_dining</span>
                  </div>
                  <h2 class="h6 mb-0 fw-bold">SweetBakey </h2>
                </div>
              </div>
              <p class="small text-muted">Crafting sweetness with love and premium organic ingredients since 2010. Your daily dose of happiness.</p>
            </div>
            <div class="col-6 col-md-3">
              <h5 class="fw-bold">Explore</h5>
              <ul class="list-unstyled small text-muted">
                <li><a href="#" class="text-decoration-none text-muted">Seasonal Specials</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Wedding Cakes</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Pastry School</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Catering</a></li>
              </ul>
            </div>
            <div class="col-6 col-md-3">
              <h5 class="fw-bold">Account</h5>
              <ul class="list-unstyled small text-muted">
                <li><a href="#" class="text-decoration-none text-muted">My Profile</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Order Tracking</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Subscription</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Gift Cards</a></li>
              </ul>
            </div>
            <div class="col-12 col-md-3">
              <h5 class="fw-bold">Support</h5>
              <ul class="list-unstyled small text-muted">
                <li><a href="#" class="text-decoration-none text-muted">Contact Us</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Delivery Map</a></li>
                <li><a href="#" class="text-decoration-none text-muted">Terms of Service</a></li>
                <li><a href="#" class="text-decoration-none text-muted">FAQ</a></li>
              </ul>
            </div>
          </div>
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mt-4 pt-4 border-top" style="border-color:rgba(0,0,0,.06)">
            <p class="mb-0 small text-muted">© 2024 Modern Bakery Co. All rights reserved.</p>
            <div class="d-flex gap-3 small text-muted mt-3 mt-md-0">
              <a href="#" class="text-muted text-decoration-none">Privacy Policy</a>
              <a href="#" class="text-muted text-decoration-none">Refund Policy</a>
              <a href="#" class="text-muted text-decoration-none">Cookie Settings</a>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <script>
      $(function(){
        const API = "https://698a9f596c6f9ebe57ba34be.mockapi.io/api/pasteles/cakes";
        const params = new URLSearchParams(window.location.search);// obtener id desde querystring
        const id = params.get('id');
        if(!id){
          $('#product-root').html('<div class="alert alert-warning">Producto no especificado. <a href="index.html">Volver</a></div>');
          return;
        }

        // cargar producto por id
        $.getJSON(`${API}/${encodeURIComponent(id)}`).done(function(item){
            // montar la estructura principal del producto (con datos básicos)
            const mainHtml = `
              <div class="row g-5">
                <div class="col-12 col-lg-6">
                  <div class="product-main bg-white shadow-sm border p-0 rounded-xl">
                    <img id="prod-image" src="${(item.imageUrl||'')}" alt="${(item.name||'')}" class="main-image">
                  </div>
                </div>

                <div class="col-12 col-lg-6">
                  <span id="prod-category" class="badge bg-light mb-3" style="background-color:rgba(238,43,91,.08);color:var(--primary);font-weight:700;"></span>
                  <h1 id="prod-name" class="h3 mb-2"></h1>
                  <p id="prod-desc" class="text-muted"></p>

                  <div class="d-flex align-items-baseline gap-3 my-3">
                    <div id="prod-price" class="fw-bold" style="color:var(--primary);font-size:1.5rem;"></div>
                  </div>

                  <div class="border-top border-bottom py-4 mb-3" style="border-color:rgba(0,0,0,.06)">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <div class="fw-bold text-muted">Quantity</div>
                      <div class="qty-box">
                        <button class="btn btn-outline-secondary" id="btn-decrease">-</button>
                        <span id="qty-value" style="min-width:36px;text-align:center;display:inline-block">1</span>
                        <button class="btn btn-outline-secondary" id="btn-increase">+</button>
                      </div>
                    </div>

                    <div class="d-flex gap-3">
                      <button class="btn btn-primary flex-grow-1" id="btn-buy">Buy Now</button>
                      <button class="btn btn-outline-secondary flex-grow-1" id="btn-add-cart">Add to Cart</button>
                    </div>
                  </div>

                  <div class="mb-3">
                    <button class="btn btn-sm btn-primary" id="btn-ingredientes">Ingredientes ▾</button>
                    <div id="ingredientes-panel" style="display:none;margin-top:.75rem" class="text-muted small p-3 bg-white border rounded"></div>
                  </div>

                  <div class="mb-2 small text-muted"><strong>Alergenos:</strong> <span id="prod-allergens"></span></div>
                </div>
              </div>
            `;
            $('#product-root').html(mainHtml);

            // rellenar datos
            $('#prod-name').text(item.name || '');
            $('#prod-desc').text(item.description || '');
            $('#prod-price').text(item.price ? '$' + item.price : '');
            $('#prod-category').text(item.category || '');
            $('#prod-allergens').text(item.allergens || '');
            $('#ingredientes-panel').text(item.ingredients || '');
  
            // interaccion: contador 
            $('#btn-increase').on('click', function(){
              $('#qty-value').text(+$('#qty-value').text() + 1);
            });

            $('#btn-decrease').on('click', function(){
              let n = +$('#qty-value').text();
              if(n > 0){
                $('#qty-value').text(n - 1);
              }
            });

            // slideToggle ingredientes
            $('#btn-ingredientes').on('click', function(){
              $('#ingredientes-panel').stop(true,true).slideToggle(200);
            });

            // cargar relacionados (ahora sí)
            loadRelatedProducts();
          }) // end product done

        // función para cargar relacionados y mostrarlos
        function loadRelatedProducts(){
          $.getJSON(API, function(list){
            const related = (list || []).slice(0,4); //tomar los 4 primeros
            const $container = $('#related-products').empty();
            related.forEach(p => {
              const card = `
                <div class="col-6 col-md-3">
                  <a href="product.html?id=${p.id}" class="text-decoration-none text-reset">
                    <div class="card border-0 h-100">
                      <img src="${p.imageUrl}" class="card-img-top rounded-3" style="height:220px;object-fit:cover;">
                      <div class="card-body p-2">
                        <h6 class="card-title mb-1 product-name">${p.name}</h6>
                        <p class="small text-muted mb-0">$${p.price}</p>
                      </div>
                    </div>
                  </a>
                </div>
              `;
              $container.append(card);
            });
          });
        } 
      });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>

  </body>
</html>
